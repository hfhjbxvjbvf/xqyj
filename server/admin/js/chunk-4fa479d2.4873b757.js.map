{"version":3,"sources":["webpack:///./src/views/ProductImages.vue?5e35","webpack:///src/views/ProductImages.vue","webpack:///./src/views/ProductImages.vue?2547","webpack:///./src/views/ProductImages.vue","webpack:///./src/views/ProductImages.vue?2aae"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","staticStyle","attrs","on","toggleSelectAll","model","value","callback","$$v","selectAll","expression","saveDateSelected","products","scopedSlots","_u","key","fn","scope","updateSelected","row","$set","image","$event","deleteProductImg","_id","currentPage","pageSize","totalProducts","fetchSlideshowAndProducts","staticRenderFns","methods","slideshowRes","$http","get","console","log","data","slideshow","slideshowArray","productIds","map","item","productId","n","length","res","productWithSlideshowId","push","error","id","response","delete","$message","success","every","product","selected","val","forEach","post","component"],"mappings":"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","file":"js/chunk-4fa479d2.4873b757.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(\"轮播图列表\")]),_c('div',[_c('el-checkbox',{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{\"label\":\"全选\"},on:{\"change\":_vm.toggleSelectAll},model:{value:(_vm.selectAll),callback:function ($$v) {_vm.selectAll=$$v},expression:\"selectAll\"}},[_vm._v(\" 全选 \")]),_c('el-button',{staticStyle:{\"margin-left\":\"85%\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveDateSelected}},[_vm._v(\" 确定 \")])],1),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.products}},[_c('el-table-column',{attrs:{\"label\":\"选择\",\"width\":\"60\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-checkbox',{on:{\"change\":_vm.updateSelected},model:{value:(scope.row.selected),callback:function ($$v) {_vm.$set(scope.row, \"selected\", $$v)},expression:\"scope.row.selected\"}})]}}])}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"商品名称\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"price\",\"label\":\"商品价格\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"category\",\"label\":\"商品分类\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"image\",\"label\":\"商品图片\",\"width\":\"180\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('img',{staticStyle:{\"width\":\"50px\",\"height\":\"50px\"},attrs:{\"src\":scope.row.image,\"alt\":\"商品图片\"}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"180\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":function($event){return _vm.deleteProductImg(scope.row._id)}}},[_vm._v(\" 删除 \")])]}}])})],1),_c('el-pagination',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"current-page\":_vm.currentPage,\"page-size\":_vm.pageSize,\"total\":_vm.totalProducts,\"layout\":\"total, prev, pager, next, jumper\"},on:{\"current-change\":_vm.fetchSlideshowAndProducts}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <h1>轮播图列表</h1>\r\n    <!-- 全选复选框 -->\r\n    <div>\r\n      <el-checkbox\r\n        v-model=\"selectAll\"\r\n        @change=\"toggleSelectAll\"\r\n        label=\"全选\"\r\n        style=\"margin-bottom: 10px\"\r\n      >\r\n        全选\r\n      </el-checkbox>\r\n      <!-- 如果点击确定的时候，将选择状态提交，避免重复提交 -->\r\n      <el-button\r\n        type=\"primary\"\r\n        @click=\"saveDateSelected\"\r\n        style=\"margin-left: 85%\"\r\n      >\r\n        确定\r\n      </el-button>\r\n    </div>\r\n\r\n    <el-table :data=\"products\" style=\"width: 100%\">\r\n      <!-- 复选框列 -->\r\n      <el-table-column label=\"选择\" width=\"60\">\r\n        <template slot-scope=\"scope\">\r\n          <el-checkbox\r\n            v-model=\"scope.row.selected\"\r\n            @change=\"updateSelected\"\r\n          ></el-checkbox>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column\r\n        prop=\"name\"\r\n        label=\"商品名称\"\r\n        width=\"180\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"price\"\r\n        label=\"商品价格\"\r\n        width=\"180\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"category\"\r\n        label=\"商品分类\"\r\n        width=\"180\"\r\n      ></el-table-column>\r\n      <el-table-column prop=\"image\" label=\"商品图片\" width=\"180\">\r\n        <template slot-scope=\"scope\">\r\n          <img\r\n            :src=\"scope.row.image\"\r\n            alt=\"商品图片\"\r\n            style=\"width: 50px; height: 50px\"\r\n          />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"180\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"danger\" @click=\"deleteProductImg(scope.row._id)\">\r\n            删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-pagination\r\n      @current-change=\"fetchSlideshowAndProducts\"\r\n      :current-page=\"currentPage\"\r\n      :page-size=\"pageSize\"\r\n      :total=\"totalProducts\"\r\n      layout=\"total, prev, pager, next, jumper\"\r\n      style=\"margin-top: 20px\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n  \r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      products: [],\r\n      selectAll: false, // 用于全选的复选框状态\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      totalProducts: 0,\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchSlideshowAndProducts() {\r\n      try {\r\n  // 获取幻灯片数据\r\n  const slideshowRes = await this.$http.get('/slideshows')\r\n  console.log('请求返回:', slideshowRes.data.slideshow)\r\n  const slideshowArray = slideshowRes.data.slideshow\r\n\r\n  // 提取 productId 列表\r\n  const productIds = slideshowArray.map((item) => item.productId)\r\n  \r\n  // 初始化 products 数组\r\n  this.products = []\r\n\r\n  let n = 0\r\n  while (n < productIds.length) {\r\n    // 获取对应 product 数据\r\n    const res = await this.$http.get(`/products/${productIds[n]}`)\r\n    \r\n    // 创建一个新对象，将幻灯片 _id 替换到 product 的 _id 上\r\n    const productWithSlideshowId = {\r\n      ...res.data,\r\n      _id: slideshowArray[n]._id  // 使用 slideshow 的 _id 覆盖 product 的 _id\r\n    }\r\n    \r\n    // 将修改后的产品信息加入 products 数组\r\n    this.products.push(productWithSlideshowId)\r\n    console.log('当前产品:', productWithSlideshowId)\r\n\r\n    n++\r\n  }\r\n} catch (error) {\r\n  console.error('获取数据失败', error)\r\n}\r\n\r\n    },\r\n\r\n    async deleteProductImg(id) {\r\n      try {\r\n        console.log('准备删除:', id)\r\n        const response = await this.$http.delete(`/slideshows/${id}`);\r\n        console.log('删除响应:', response) // 打印删除结果\r\n        this.$message.success('删除成功')\r\n        this.products = []\r\n        this.fetchSlideshowAndProducts() // 刷新列表\r\n      } catch (error) {\r\n        this.$message.error('删除失败，请重试！')\r\n        console.error('删除轮播图时发生错误:', error)\r\n      }\r\n    },\r\n    updateSelected() {\r\n      // 当有任意单个复选框改变时，更新全选按钮的状态\r\n      this.selectAll = this.products.every((product) => product.selected)\r\n    },\r\n    toggleSelectAll(val) {\r\n      // 当全选按钮状态改变时，更新所有行的复选框状态\r\n      this.products.forEach((product) => {\r\n        product.selected = val\r\n      })\r\n    },\r\n    async saveDateSelected() {\r\n      try {\r\n        console.log('准备发送请求')\r\n        const response = await this.$http.post('/slideshows', this.products)\r\n        console.log('请求返回:', response)\r\n        this.$message.success('保存成功')\r\n      } catch (error) {\r\n        this.$message.error('保存失败，请重试！')\r\n        console.error('保存失败:', error)\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.fetchSlideshowAndProducts()\r\n  },\r\n}\r\n</script>\r\n\r\n  <style scoped>\r\n/* 可以根据需要添加样式 */\r\n</style>\r\n  ","import mod from \"-!../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/index.js??vue-loader-options!./ProductImages.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/index.js??vue-loader-options!./ProductImages.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ProductImages.vue?vue&type=template&id=4207d9d5&scoped=true\"\nimport script from \"./ProductImages.vue?vue&type=script&lang=js\"\nexport * from \"./ProductImages.vue?vue&type=script&lang=js\"\nimport style0 from \"./ProductImages.vue?vue&type=style&index=0&id=4207d9d5&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4207d9d5\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/.pnpm/mini-css-extract-plugin@0.9.0_webpack@4.47.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/.pnpm/css-loader@3.6.0_webpack@4.47.0/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/index.js??vue-loader-options!./ProductImages.vue?vue&type=style&index=0&id=4207d9d5&prod&scoped=true&lang=css\""],"sourceRoot":""}