(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fa479d2"],{"28dc":function(t,e,l){},"5f09":function(t,e,l){"use strict";l.r(e);var s=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("h1",[t._v("轮播图列表")]),l("div",[l("el-checkbox",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"全选"},on:{change:t.toggleSelectAll},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}},[t._v(" 全选 ")]),l("el-button",{staticStyle:{"margin-left":"85%"},attrs:{type:"primary"},on:{click:t.saveDateSelected}},[t._v(" 确定 ")])],1),l("el-table",{staticStyle:{width:"100%"},attrs:{data:t.products}},[l("el-table-column",{attrs:{label:"选择",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-checkbox",{on:{change:t.updateSelected},model:{value:e.row.selected,callback:function(l){t.$set(e.row,"selected",l)},expression:"scope.row.selected"}})]}}])}),l("el-table-column",{attrs:{prop:"name",label:"商品名称",width:"180"}}),l("el-table-column",{attrs:{prop:"price",label:"商品价格",width:"180"}}),l("el-table-column",{attrs:{prop:"category",label:"商品分类",width:"180"}}),l("el-table-column",{attrs:{prop:"image",label:"商品图片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[l("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.row.image,alt:"商品图片"}})]}}])}),l("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{type:"danger"},on:{click:function(l){return t.deleteProductImg(e.row._id)}}},[t._v(" 删除 ")])]}}])})],1),l("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.currentPage,"page-size":t.pageSize,total:t.totalProducts,layout:"total, prev, pager, next, jumper"},on:{"current-change":t.fetchSlideshowAndProducts}})],1)},o=[],c={data(){return{products:[],selectAll:!1,currentPage:1,pageSize:10,totalProducts:0}},methods:{async fetchSlideshowAndProducts(){try{const t=await this.$http.get("/slideshows");console.log("请求返回:",t.data.slideshow);const e=t.data.slideshow,l=e.map(t=>t.productId);this.products=[];let s=0;while(s<l.length){const t=await this.$http.get("/products/"+l[s]),o={...t.data,_id:e[s]._id};this.products.push(o),console.log("当前产品:",o),s++}}catch(t){console.error("获取数据失败",t)}},async deleteProductImg(t){try{console.log("准备删除:",t);const e=await this.$http.delete("/slideshows/"+t);console.log("删除响应:",e),this.$message.success("删除成功"),this.products=[],this.fetchSlideshowAndProducts()}catch(e){this.$message.error("删除失败，请重试！"),console.error("删除轮播图时发生错误:",e)}},updateSelected(){this.selectAll=this.products.every(t=>t.selected)},toggleSelectAll(t){this.products.forEach(e=>{e.selected=t})},async saveDateSelected(){try{console.log("准备发送请求");const t=await this.$http.post("/slideshows",this.products);console.log("请求返回:",t),this.$message.success("保存成功")}catch(t){this.$message.error("保存失败，请重试！"),console.error("保存失败:",t)}}},created(){this.fetchSlideshowAndProducts()}},a=c,r=(l("eb11"),l("d34b")),n=Object(r["a"])(a,s,o,!1,null,"4207d9d5",null);e["default"]=n.exports},eb11:function(t,e,l){"use strict";l("28dc")}}]);
//# sourceMappingURL=chunk-4fa479d2.4873b757.js.map